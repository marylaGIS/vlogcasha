<!DOCTYPE html>
<html lang="pl">
<head>
	<base target="_top">
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	<title>Indie 2022 - Vlog Casha</title>

	<link rel="shortcut icon" type="image/x-icon" href="https://yt3.googleusercontent.com/ytc/AGIKgqNjMTErUO9AYJmIG2fnKmB1XgBBJ3iNgBR5S3Nhig=s176-c-k-c0x00ffffff-no-rj" />

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js" integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM=" crossorigin=""></script>
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
	
	<link rel="stylesheet" href="leaflet-sidepanel.css" />
	<script src="leaflet-sidepanel.min.js"></script>
	
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	
	<link rel="stylesheet" href="style.css" />
	
	<script src="indie.geojson"></script>

	<style>
		html, body, #map {
			height: 100%;
			width: 100%;
			margin: 0;
		}
	</style>
</head>

<body>

	<div id="map">
	
		<div class="cash-socials">
			<strong>Vlog Casha</strong>
			<a href="https://www.youtube.com/@vlogcasha" target="_blank"><i class="fa fa-youtube"></i></a>
			<a href="https://www.facebook.com/vlogcasha" target="_blank"><i class="fa fa-facebook-official"></i></a>
			<a href="https://www.instagram.com/vlogcasha/" target="_blank"><i class="fa fa-instagram"></i></a>
			<a href="https://patronite.pl/Vlogcasha" target="_blank"><i class="fa fa-fire"></i></a>
		</div>
		
		<div id="sidepanel" class="sidepanel" aria-label="side panel" aria-hidden="false">
			<div class="sidepanel-inner-wrapper">
				<nav class="sidepanel-tabs-wrapper" aria-label="sidepanel tab navigation">
				<ul class="sidepanel-tabs" id="sidepanel-tabs">
					<li class="sidepanel-tab">
						<a href="#" class="sidebar-tab-link" role="tab" data-tab-link="tab-1">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-list" viewBox="0 0 16 16">
								<path fill-rule="evenodd" d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"/>
							</svg>
						</a>
					</li>
					
					<li class="sidepanel-tab">
						<a href="#" class="sidebar-tab-link" role="tab" data-tab-link="tab-2">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-geo-alt-fill" viewBox="0 0 16 16">
								<path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"/>
							</svg>
						</a>
					</li>
					
					<li class="sidepanel-tab">
						<a href="#" class="sidebar-tab-link" role="tab" data-tab-link="tab-3">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-youtube" viewBox="0 0 16 16">
								  <path d="M8.051 1.999h.089c.822.003 4.987.033 6.11.335a2.01 2.01 0 0 1 1.415 1.42c.101.38.172.883.22 1.402l.01.104.022.26.008.104c.065.914.073 1.77.074 1.957v.075c-.001.194-.01 1.108-.082 2.06l-.008.105-.009.104c-.05.572-.124 1.14-.235 1.558a2.007 2.007 0 0 1-1.415 1.42c-1.16.312-5.569.334-6.18.335h-.142c-.309 0-1.587-.006-2.927-.052l-.17-.006-.087-.004-.171-.007-.171-.007c-1.11-.049-2.167-.128-2.654-.26a2.007 2.007 0 0 1-1.415-1.419c-.111-.417-.185-.986-.235-1.558L.09 9.82l-.008-.104A31.4 31.4 0 0 1 0 7.68v-.123c.002-.215.01-.958.064-1.778l.007-.103.003-.052.008-.104.022-.26.01-.104c.048-.519.119-1.023.22-1.402a2.007 2.007 0 0 1 1.415-1.42c.487-.13 1.544-.21 2.654-.26l.17-.007.172-.006.086-.003.171-.007A99.788 99.788 0 0 1 7.858 2h.193zM6.4 5.209v4.818l4.157-2.408L6.4 5.209z"/>
								</svg>
						</a>
					</li>
				</ul>
				</nav>
				<div class="sidepanel-content-wrapper">
					<div class="sidepanel-content" id="sidepanel-content">
						<div class="sidepanel-tab-content" data-tab-content="tab-1" id="panel-vlogs-attractions">
							<h3>Lista vlogów i odwiedzonych miejsc</h3>
						</div>
						
						<div class="sidepanel-tab-content" data-tab-content="tab-2" id="panel-vlogs-attractions">
							<h3>Atrakcje według kategorii</h3>
							<ul id="miejsce" class="list-attractions"><strong>Miejsca</strong></ul>
							<ul id="swiatynia" class="list-attractions"><strong>Świątynie</strong></ul>
							<ul id="architektura" class="list-attractions"><strong>Architektura</strong></ul>
							<ul id="fort" class="list-attractions"><strong>Forty</strong></ul>
							<ul id="park" class="list-attractions"><strong>Parki</strong></ul>
							<ul id="nocleg" class="list-attractions"><strong>Noclegi</strong></ul>
							<ul id="restauracja" class="list-attractions"><strong>Restauracje</strong></ul>
							<ul id="rozne" class="list-attractions"><strong>Różne</strong></ul>
						</div>
						
						<div class="sidepanel-tab-content" data-tab-content="tab-3" id="panel-vlogs-attractions">
							<h3>Lista vlogów</h3>
							<ol id="list-vlogs-yt"></ol>
						</div>
					</div>
				</div>
			</div>
			<div class="sidepanel-toggle-container">
				<button class="sidepanel-toggle-button" type="button" aria-label="toggle side panel"></button>
			</div>
		</div>
	
	</div>

<script>

	var map = L.map('map').setView([25.45319, 76.90429], 6);

	var OSM = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
		attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>' 
		+ ' | <a href="https:\\marylagis.github.io">marylaGIS</a> <a href="https://www.linkedin.com/in/marylajez/" target="_blank"><i class="fa fa-linkedin"></i></a>'
	}).addTo(map);
	
	var Esri_WorldImagery = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
		attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'
	});
	
	var OpenTopoMap = L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
		maxZoom: 17,
		attribution: 'Map data: &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, <a href="http://viewfinderpanoramas.org">SRTM</a> | Map style: &copy; <a href="https://opentopomap.org">OpenTopoMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'
	});

	
	map.on('click', function (e) {
		console.log(e.latlng.lng.toFixed(5) + ',', e.latlng.lat.toFixed(5));
	});
	
	const vlogsLegendDict = {};
	
	for (let i=1; i<=19; i++) {
		vlogsLegendDict["vlog #"+i] = L.featureGroup();
	};
	
	function style_points() {
		return {
			radius: 5.0,
			color: 'black',
			weight: 2,
			opacity: 0.8,
			fillColor: 'white',
			fillOpacity: 1.0
		}
	};
	
	function onEachFeature(feature, layer) {
		layer.bindPopup("<strong>YouTube: </strong>" + 
		"<a href=" + feature.properties["link"] + 
		" target='_blank'>vlog " + feature.properties["vlog_nr"] + "</a>" + 
		"<br>" + "<strong>Obiekt: </strong>" + 
		feature.properties["obiekt"] + "<br>" + "<strong>Data: </strong>" + 
		feature.properties["data"]);
		
		for (let i=1; i<=19; i++) {
			if (parseInt(feature.properties["vlog_nr"]) == i) {
				vlogsLegendDict["vlog #"+i].addLayer(layer);
			};
		};
	};
	
	var line_points = [];
	
	var points = L.geoJSON(indie2022points, {
		onEachFeature: onEachFeature,
		pointToLayer: function (feature, latlng) {
			line_points.push(latlng);
			return L.circleMarker(latlng, style_points(feature))
		}
	})//.addTo(map);
	
	var lines = L.layerGroup().addTo(map);
	
	for (let i=0; i<=102; i++) {
		let r=240+i/3; let g=i*-1.5+200; let b=i*-2+100;
		c = 'rgb(' + r +','+g+','+b+')'
		var line = L.polyline([line_points[i], line_points[i+1]], {
			color: c
		}).bindPopup((i+1).toString())
		lines.addLayer(line);
	};
	
	
	points.addTo(map);  // last to add, first to see
	
	var baseLayers = {
		"OpenStreetMap": OSM,
		"Satelita": Esri_WorldImagery,
		"OpenTopoMap": OpenTopoMap
	};
	
	var overlays = {
		"punkty": points,
		"linie": lines
	};
	
	for (const [key, value] of Object.entries(vlogsLegendDict)) {
		overlays[key] = value;
	};
	
	L.control.layers(baseLayers, overlays).addTo(map);
	
	
	const sidepanel = L.control.sidepanel('sidepanel', {
		tabsPosition: 'left',
		startTab: 'tab-1'
	}).addTo(map);
	
	// tab-1
	for (let i=1; i<=19; i++) {
		const ul = document.createElement("ul");
		ul.setAttribute("id", "list-vlogs-attractions");
		
		const li = document.createElement("li");
		li.setAttribute("class", "li-vlog-attractions");
		
		const btn = document.createElement("button");
		btn.setAttribute("id", "btn-"+i);
		btn.innerText = "VLOG " + i;
		
		li.appendChild(btn);
		
		const div = document.createElement("div");
		div.setAttribute("id", "div-"+i);
		div.setAttribute("class", "vlog-attractions");

		const ul2 = document.createElement("ul");
		ul2.setAttribute("id", "ul-"+i);
		ul2.setAttribute("calss", "attractions");
		div.appendChild(ul2);
		
		li.appendChild(div);
				
		document.getElementById("panel-vlogs-attractions").appendChild(li);
	};
	
	for (let i in indie2022points.features) {
		for (let a=1; a<=19; a++) {
			const ul = document.getElementById("ul-"+a);
			
			if (parseInt(indie2022points.features[i].properties["vlog_nr"]) == a) {
				const li = document.createElement("li");
				li.innerText = indie2022points.features[i].properties["obiekt"];
				
				const item = document.createElement("i");
				item.setAttribute("class", "fa fa-map-marker");
				item.setAttribute("title", "przybliż");
				li.appendChild(item);
				
				const geom = indie2022points.features[i].geometry;
				const latLng = L.latLng(geom.coordinates[1], geom.coordinates[0])
				
				item.onclick = function () {
					map.flyTo(latLng, 16, {animate: false});
					
					const popup = L.popup();
					popup.setLatLng(latLng)
					popup.setContent(indie2022points.features[i].properties["obiekt"])
					popup.openOn(map);
				};
				
				ul.appendChild(li);
			};
		};
	};
	
	const liVlogAttractions = document.querySelectorAll(".li-vlog-attractions");
	
	for (let el of liVlogAttractions) {
		const btn = el.querySelector("button");
		const list = el.querySelector(".vlog-attractions");
		
		btn.addEventListener("click", function() {
			list.classList.toggle("vlog-attractions");
		});
	};
	
	// tab-2
	const categoriesSet = new Set();
	
	for (let i in indie2022points.features) {
		categoriesSet.add(indie2022points.features[i].properties["kategoria"]);
	};
	
	for (let i in indie2022points.features) {
		categoriesSet.forEach( el => {
			if (indie2022points.features[i].properties["kategoria"] == el) {
				const li = document.createElement("li");
				li.innerText = indie2022points.features[i].properties["obiekt"];
						
				const item = document.createElement("i");
				item.setAttribute("class", "fa fa-map-marker");
				item.setAttribute("title", "przybliż");
				li.appendChild(item);
				
				const geom = indie2022points.features[i].geometry;
				const latLng = L.latLng(geom.coordinates[1], geom.coordinates[0])
				
				item.onclick = function () {
					map.flyTo(latLng, 16, {animate: false});
					
					const popup = L.popup();
					popup.setLatLng(latLng)
					popup.setContent(indie2022points.features[i].properties["obiekt"])
					popup.openOn(map);
				};
				
				ul = document.getElementById(el);
				ul.appendChild(li);
				};
			}
		)
	};
	
	// tab-3
	const vlogsLinksSet = new Set();
	
	for (let i=0; i<indie2022points.features.length; i++) {
		vlogsLinksSet.add(indie2022points.features[i].properties["link"]);
	};
	
	const ol = document.getElementById("list-vlogs-yt");  // list created inside sidepanel tab above
	
	vlogsLinksSet.forEach( el => {
		const li = document.createElement("li");
		const iframe = document.createElement("iframe");
		iframe.classList.add("vlog-yt");
		iframe.setAttribute("src", el.replace("watch?v=", "embed/"));
		li.appendChild(iframe);
		ol.appendChild(li);
	});
	
</script>

</body>
</html>
